<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Filtro de Leads RD Station</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../assets/css/template.css" />
  <link rel="stylesheet" href="../assets/css/filtro-leads.css" />
</head>
<body>
  <div class="page-wrapper">
    <header class="page-header">
      <div class="container">
        <nav class="progress-steps" aria-label="Etapas do disparador">
          <div class="progress-step active">
            <span class="progress-step__icon" aria-hidden="true">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8">
                <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.09 9.09 0 01-6 2.28 9.09 9.09 0 01-6-2.28m12 0a9.03 9.03 0 002-5.78V12a6 6 0 10-12 0v.94a9.03 9.03 0 002 5.78m12 0a8.96 8.96 0 01-4-2.72M6 18.72a8.96 8.96 0 004-2.72" />
              </svg>
            </span>
            <span>Contatos</span>
          </div>
          <div class="progress-separator" aria-hidden="true"></div>
          <div class="progress-step">
            <span class="progress-step__icon" aria-hidden="true">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904A7.5 7.5 0 0112 3v3.75a.75.75 0 00.75.75h3.75a7.5 7.5 0 01-6.75 7.404z" />
              </svg>
            </span>
            <span>Ações</span>
          </div>
          <div class="progress-separator" aria-hidden="true"></div>
          <div class="progress-step">
            <span class="progress-step__icon" aria-hidden="true">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m-6-8h6m5 12H4a2 2 0 01-2-2V6a2 2 0 012-2h7l2 2h7a2 2 0 012 2v12a2 2 0 01-2 2z" />
              </svg>
            </span>
            <span>Revisão</span>
          </div>
          <div class="progress-separator" aria-hidden="true"></div>
          <div class="progress-step">
            <span class="progress-step__icon" aria-hidden="true">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 13.5l6.75-6.75a2.121 2.121 0 013 0L21 15M3 13.5V21h7.5" />
              </svg>
            </span>
            <span>Resultados</span>
          </div>
        </nav>

        <div class="page-heading">
          <h1>Selecione os destinatários</h1>
          <p>Escolha os leads que receberão a próxima etapa de comunicação. Combine filtros, revise os resultados e confirme a seleção.</p>
        </div>
      </div>
    </header>

    <main class="content">
      <div class="container">
        <div class="layout-grid">
          <section class="panel filter-panel" aria-labelledby="filtrosTitulo">
            <div class="panel-header">
              <h2 id="filtrosTitulo">Filtros</h2>
              <p>Defina funil, etapas, responsáveis e período para localizar oportunidades específicas.</p>
            </div>

            <div class="filter-group">
              <div class="form-field">
                <label for="funil">Funil</label>
                <select id="funil" class="form-select" aria-describedby="funilHint"></select>
                <small id="funilHint" class="field-hint">Selecione o funil para carregar as etapas disponíveis.</small>
              </div>

              <div class="form-field">
                <label for="etapasSelect">Etapas <span id="etapasCount" class="badge"></span></label>
                <div id="etapasSelectBox" class="multi-select">
                  <div class="multi-select__trigger" onclick="toggleMenu('etapasMenu')">
                    <select id="etapasSelect" class="form-select" disabled>
                      <option>Selecionar etapas</option>
                    </select>
                  </div>
                  <div id="etapasMenu" class="multi-select__menu"></div>
                </div>
                <select id="etapaHidden" multiple hidden></select>
              </div>

              <div class="form-field">
                <label for="dataInicio">Data início</label>
                <input type="date" id="dataInicio" class="form-control" />
              </div>

              <div class="form-field">
                <label for="dataFim">Data fim</label>
                <input type="date" id="dataFim" class="form-control" />
              </div>

              <hr class="filter-divider" />

              <div class="form-field">
                <label for="respSelect">Responsável <span id="respCount" class="badge"></span></label>
                <div id="respSelectBox" class="multi-select">
                  <div class="multi-select__trigger" onclick="toggleMenu('respMenu')">
                    <select id="respSelect" class="form-select" disabled>
                      <option>Selecionar responsáveis</option>
                    </select>
                  </div>
                  <div id="respMenu" class="multi-select__menu"></div>
                </div>
                <select id="respHidden" multiple hidden></select>
              </div>

              <div class="form-field">
                <label for="status">Status</label>
                <select id="status" class="form-select">
                  <option value="">Todos os status</option>
                  <option value="null">Em andamento</option>
                  <option value="true">Vendido</option>
                  <option value="false">Perdido</option>
                </select>
              </div>

              <div class="form-field">
                <label for="motivoSelect" id="motivoLabel">Motivo de perda <span id="motivoCount" class="badge"></span></label>
                <div id="motivoSelectBox" class="multi-select disabled">
                  <div class="multi-select__trigger" onclick="toggleMenu('motivoMenu')">
                    <select id="motivoSelect" class="form-select" disabled>
                      <option>Selecionar motivos</option>
                    </select>
                  </div>
                  <div id="motivoMenu" class="multi-select__menu"></div>
                </div>
                <select id="motivoHidden" multiple hidden></select>
              </div>
            </div>

            <div class="panel-footer">
              <button id="filtrarContatos" class="btn btn-primary" type="button">
                <span class="btn-text">Buscar leads</span>
                <span class="spinner-border spinner-border-sm d-none" id="loadingBtn" role="status" aria-hidden="true"></span>
              </button>
            </div>
          </section>

          <section class="panel leads-panel" aria-labelledby="resultadosTitulo">
            <header>
              <div class="panel-header__top">
                <div>
                  <h2 id="resultadosTitulo">Destinatários disponíveis</h2>
                  <p class="field-hint">Revise os resultados e selecione as oportunidades que seguirão para a próxima etapa.</p>
                </div>
                <div class="panel-header__actions">
                  <div class="search-input">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-4.35-4.35M18 10.5a7.5 7.5 0 11-15 0 7.5 7.5 0 0115 0z" />
                    </svg>
                    <input type="search" id="buscaLeads" class="form-control" placeholder="Pesquisar por nome, telefone ou responsável" />
                  </div>
                  <button id="btnSelecionarTudo" class="btn btn-secondary" type="button">Selecionar tudo</button>
                </div>
              </div>
            </header>

            <div class="metrics-bar">
              <span id="infoTotalLeads">0 leads disponíveis • 0 selecionados</span>
              <div class="controls">
                <label for="quantidadePorPagina">Leads por página</label>
                <select id="quantidadePorPagina" class="form-select">
                  <option value="20">20</option>
                  <option value="50" selected>50</option>
                  <option value="100">100</option>
                </select>
              </div>
            </div>

            <div id="listaContatos" class="lead-list" role="list"></div>

            <div class="pagination-controls">
              <button id="btnAnterior" class="btn btn-link" type="button">⬅ Anterior</button>
              <span id="paginacaoInfo">Página 1 de 1</span>
              <button id="btnProximo" class="btn btn-link" type="button">Próximo ➡</button>
            </div>
          </section>

          <section class="panel selection-panel" aria-labelledby="selecionadosTitulo">
            <div class="panel-header">
              <div class="selection-summary">
                <div>
                  <h2 id="selecionadosTitulo">Destinatários selecionados</h2>
                  <p class="field-hint">Os contatos selecionados serão encaminhados para o disparador.</p>
                </div>
                <span class="badge success" id="contadorSelecionados">0 selecionados</span>
              </div>
              <div class="selection-actions">
                <button id="btnLimparSelecao" class="btn btn-secondary" type="button">Limpar seleção</button>
              </div>
            </div>

            <textarea id="contatos" class="form-control" rows="8" readonly placeholder="id;nome;telefone;responsavel;motivo_perda"></textarea>

            <div class="panel-footer">
              <button id="irParaDisparador" class="btn btn-primary" type="button" disabled>Próximo</button>
            </div>
          </section>
        </div>
      </div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="../assets/js/filtro-leads.js"></script>
</body>
</html>
